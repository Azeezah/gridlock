<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>repl.it</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <script src="script.js"></script>
<table>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
<style>
table {
	width: 500px;
	height:500px;
	border: dotted red;
}
td {
	border: solid grey;
}

  .seen {
    background-color: grey;
  }
</style>
<script>
let moves_stack = []
let moves_set = new Set();
let start = {x:4, y:4}
let curr = {x:4, y:4}

function render() {
  const rows = document.querySelectorAll('table tr');
  for (let y=0; y<rows.length; y++) {
    for (let x=0; x<rows[y].children.length; x++) {
      if (moves_set.has(x+';'+y)) {
        rows[y].children[x].classList.add('seen');
      } else {
        rows[y].children[x].classList.remove('seen');
      }
    }
  }
}
exec_mv(0, 0);
// let react generate the html
function exec_mv(dx, dy) {
  const sq = (curr.x+dx)+";"+(curr.y+dy);
  const on_board =
    (0 <= curr.x+dx && curr.x+dx <= 8) 
    && (0 <= curr.y+dy && curr.y+dy <= 8);
  if (sq == moves_stack[moves_stack.length-2]) {
    // undo:
    moves_set.delete(moves_stack.pop());
    curr.x += dx;
    curr.y += dy;
  } else if (moves_set.has(sq) || !on_board) {
    // surface alert, invalid move
    console.log('invalid');
  } else {
    // do move:
    moves_set.add(sq)
    moves_stack.push(sq)
    curr.x += dx;
    curr.y += dy;
  }
  render();
}

document.onkeydown = function (e) {
    e = e || window.event;
    const up = 38, down = 40, left=37, right = 39;
    switch (e.keyCode) {
      case up: {
        exec_mv(0, -1);
        break;
      }
      case down: {
        exec_mv(0, 1);
        break;
      }
      case right: {
        exec_mv(1, 0);
        break;
      }
      case left: {
        exec_mv(-1, 0);
        break;
      }
    }
}
</script>

  </body>
</html>
